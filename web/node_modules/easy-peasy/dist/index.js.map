{"version":3,"file":"index.js","sources":["../src/context.js","../src/hooks.js","../src/constants.js","../src/helpers.js","../src/lib.js","../src/create-reducer.js","../src/persistence.js","../src/actions.js","../src/thunks.js","../src/listeners.js","../src/computed-properties.js","../src/effects.js","../src/extract-data-from-model.js","../src/create-store.js","../src/create-context-store.js","../src/create-transform.js","../src/provider.js","../src/use-local-store.js","../src/index.js"],"sourcesContent":["import { createContext } from 'react';\n\nconst StoreContext = createContext();\n\nexport default StoreContext;\n","import { useContext, useDebugValue, useEffect, useState } from 'react';\nimport EasyPeasyContext from './context';\n\nconst useNotInitialized = () => {\n  throw new Error('uSES not initialized!');\n};\nlet useSyncExternalStoreWithSelector = useNotInitialized;\nexport const initializeUseStoreState = (fn) => {\n  useSyncExternalStoreWithSelector = fn;\n};\n\nconst refEquality = (a, b) => a === b;\n\nexport function createStoreStateHook(Context) {\n  return function useStoreState(mapState, equalityFn = refEquality) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (!mapState) {\n        throw new Error(`You must pass a selector to useStoreState`);\n      }\n      if (typeof mapState !== 'function') {\n        throw new Error(\n          `You must pass a function as a selector to useStoreState`,\n        );\n      }\n      if (typeof equalityFn !== 'function') {\n        throw new Error(\n          `You must pass a function as an equality function to useStoreState`,\n        );\n      }\n    }\n\n    const store = useContext(Context);\n\n    /*\n    function useSyncExternalStoreWithSelector<Snapshot, Selection>(\n        subscribe: (onStoreChange: () => void) => () => void,\n        getSnapshot: () => Snapshot,\n        getServerSnapshot: undefined | null | (() => Snapshot),\n        selector: (snapshot: Snapshot) => Selection,\n        isEqual?: (a: Selection, b: Selection) => boolean,\n    ): Selection;\n    */\n    const selectedState = useSyncExternalStoreWithSelector(\n      store.subscribe,\n      store.getState,\n      store.getServerState || store.getState,\n      mapState,\n      equalityFn,\n    );\n\n    useDebugValue(selectedState);\n\n    return selectedState;\n  };\n}\n\nexport const useStoreState = createStoreStateHook(EasyPeasyContext);\n\nexport function createStoreActionsHook(Context) {\n  return function useStoreActions(mapActions) {\n    const store = useContext(Context);\n    return mapActions(store.getActions());\n  };\n}\n\nexport const useStoreActions = createStoreActionsHook(EasyPeasyContext);\n\nexport function createStoreDispatchHook(Context) {\n  return function useStoreDispatch() {\n    const store = useContext(Context);\n    return store.dispatch;\n  };\n}\n\nexport const useStoreDispatch = createStoreDispatchHook(EasyPeasyContext);\n\nexport function useStore() {\n  return useContext(EasyPeasyContext);\n}\n\nexport function createStoreRehydratedHook(Context) {\n  return function useStoreRehydrated() {\n    const store = useContext(Context);\n    const [rehydrated, setRehydrated] = useState(false);\n    useEffect(() => {\n      store.persist.resolveRehydration().then(() => setRehydrated(true));\n    }, []);\n    return rehydrated;\n  };\n}\n\nexport const useStoreRehydrated = createStoreRehydratedHook(EasyPeasyContext);\n\nexport function createTypedHooks() {\n  return {\n    useStoreActions,\n    useStoreDispatch,\n    useStoreState,\n    useStoreRehydrated,\n    useStore,\n  };\n}\n","export const actionSymbol = '$_a';\nexport const actionOnSymbol = '$_aO';\nexport const computedSymbol = '$_c';\nexport const effectOnSymbol = '$_e';\nexport const persistSymbol = '$_p';\nexport const reducerSymbol = '$_r';\nexport const thunkOnSymbol = '$_tO';\nexport const thunkSymbol = '$_t';\n","import { isDraft, current } from 'immer';\nimport {\n  actionOnSymbol,\n  actionSymbol,\n  computedSymbol,\n  effectOnSymbol,\n  persistSymbol,\n  reducerSymbol,\n  thunkOnSymbol,\n  thunkSymbol,\n} from './constants';\n\nexport const debug = (state) => {\n  if (isDraft(state)) {\n    return current(state);\n  }\n  return state;\n};\n\nexport const actionOn = (targetResolver, fn, config) => ({\n  [actionOnSymbol]: true,\n  fn,\n  targetResolver,\n  config\n});\n\nexport const action = (fn, config) => ({\n  [actionSymbol]: true,\n  fn,\n  config\n});\n\nconst defaultStateResolvers = [(state) => state];\n\nexport const computed = (fnOrStateResolvers, fn) => {\n  if (typeof fn === 'function') {\n    return {\n      [computedSymbol]: true,\n      fn,\n      stateResolvers: fnOrStateResolvers,\n    };\n  }\n  return {\n    [computedSymbol]: true,\n    fn: fnOrStateResolvers,\n    stateResolvers: defaultStateResolvers,\n  };\n};\n\nexport function unstable_effectOn(dependencyResolvers, fn) {\n  return {\n    [effectOnSymbol]: true,\n    dependencyResolvers,\n    fn,\n  };\n}\n\nexport function generic(value) {\n  return value;\n}\n\nexport const persist = (model, config) =>\n  // if we are not running in a browser context this becomes a no-op\n  typeof window === 'undefined'\n    ? model\n    : {\n        ...model,\n        [persistSymbol]: config,\n      };\n\nexport const thunkOn = (targetResolver, fn) => ({\n  [thunkOnSymbol]: true,\n  fn,\n  targetResolver,\n});\n\nexport const thunk = (fn) => ({\n  [thunkSymbol]: true,\n  fn,\n});\n\nexport const reducer = (fn, config) => ({\n  [reducerSymbol]: true,\n  fn,\n  config\n});\n","import React from 'react';\nimport { Immer, isDraft } from 'immer';\n\n/**\n * We create our own immer instance to avoid potential issues with autoFreeze\n * becoming default enabled everywhere. We want to disable autofreeze as it\n * does not suit the design of Easy Peasy.\n * https://github.com/immerjs/immer/issues/681#issuecomment-705581111\n */\nlet easyPeasyImmer;\n\nexport function isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n\n  let proto = obj;\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\nexport function clone(source) {\n  function recursiveClone(current) {\n    const next = Object.keys(current).reduce((acc, key) => {\n      if (Object.getOwnPropertyDescriptor(current, key).get == null) {\n        acc[key] = current[key];\n      }\n      return acc;\n    }, {});\n    Object.keys(next).forEach((key) => {\n      if (isPlainObject(next[key])) {\n        next[key] = recursiveClone(next[key]);\n      }\n    });\n    return next;\n  }\n  return recursiveClone(source);\n}\n\nexport function isPromise(x) {\n  return x != null && typeof x === 'object' && typeof x.then === 'function';\n}\n\nexport function get(path, target) {\n  return path.reduce(\n    (acc, cur) => (isPlainObject(acc) ? acc[cur] : undefined),\n    target,\n  );\n}\n\nexport function newify(currentPath, currentState, finalValue) {\n  if (currentPath.length === 0) {\n    return finalValue;\n  }\n  const newState = { ...currentState };\n  const key = currentPath[0];\n  if (currentPath.length === 1) {\n    newState[key] = finalValue;\n  } else {\n    newState[key] = newify(currentPath.slice(1), newState[key], finalValue);\n  }\n  return newState;\n}\n\nexport function set(path, target, value) {\n  if (path.length === 0) {\n    if (typeof value === 'object') {\n      Object.keys(target).forEach((key) => {\n        delete target[key];\n      });\n      Object.keys(value).forEach((key) => {\n        target[key] = value[key];\n      });\n    }\n    return;\n  }\n  path.reduce((acc, cur, idx) => {\n    if (idx + 1 === path.length) {\n      acc[cur] = value;\n    } else {\n      acc[cur] = acc[cur] || {};\n    }\n    return acc[cur];\n  }, target);\n}\n\nexport function createSimpleProduce(disableImmer = false) {\n  return function simpleProduce(path, state, fn, config) {\n    if ((config && 'immer' in config) ? config?.immer === false : disableImmer) {\n      const current = get(path, state);\n      const next = fn(current);\n      if (current !== next) {\n        return newify(path, state, next);\n      }\n      return state;\n    }\n    if (!easyPeasyImmer) {\n      easyPeasyImmer = new Immer({\n        // We need to ensure that we disable proxies if they aren't available\n        // on the environment. Users need to ensure that they use the enableES5\n        // feature of immer.\n        useProxies:\n          typeof Proxy !== 'undefined' &&\n          typeof Proxy.revocable !== 'undefined' &&\n          typeof Reflect !== 'undefined',\n        // Autofreezing breaks easy-peasy, we need a mixed version of immutability\n        // and mutability in order to apply updates to our computed properties\n        autoFreeze: false,\n      });\n    }\n    if (path.length === 0) {\n      const draft = easyPeasyImmer.createDraft(state);\n      const result = fn(draft);\n      if (result) {\n        return isDraft(result) ? easyPeasyImmer.finishDraft(result) : result;\n      }\n      return easyPeasyImmer.finishDraft(draft);\n    }\n    const parentPath = path.slice(0, path.length - 1);\n    const draft = easyPeasyImmer.createDraft(state);\n    const parent = get(parentPath, state);\n    const current = get(path, draft);\n    const result = fn(current);\n\n    if (result) {\n      parent[path[path.length - 1]] = result;\n    }\n    return easyPeasyImmer.finishDraft(draft);\n  };\n}\n\nconst pReduce = (iterable, reducer, initialValue) =>\n  new Promise((resolve, reject) => {\n    const iterator = iterable[Symbol.iterator]();\n    let index = 0;\n\n    const next = (total) => {\n      const element = iterator.next();\n\n      if (element.done) {\n        resolve(total);\n        return;\n      }\n\n      Promise.all([total, element.value])\n        .then((value) =>\n          // eslint-disable-next-line no-plusplus\n          next(reducer(value[0], value[1], index++)),\n        )\n        .catch((err) => reject(err));\n    };\n\n    next(initialValue);\n  });\n\nexport const pSeries = (tasks) => {\n  const results = [];\n  return pReduce(tasks, (_, task) =>\n    task().then((value) => {\n      results.push(value);\n    }),\n  ).then(() => results);\n};\n\nexport function areInputsEqual(newInputs, lastInputs) {\n  if (newInputs.length !== lastInputs.length) {\n    return false;\n  }\n  for (let i = 0; i < newInputs.length; i += 1) {\n    if (newInputs[i] !== lastInputs[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function useMemoOne(\n  // getResult changes on every call,\n  getResult,\n  // the inputs array changes on every call\n  inputs,\n) {\n  // using useState to generate initial value as it is lazy\n  const initial = React.useState(() => ({\n    inputs,\n    result: getResult(),\n  }))[0];\n\n  const committed = React.useRef(initial);\n\n  // persist any uncommitted changes after they have been committed\n\n  const isInputMatch = Boolean(\n    inputs &&\n      committed.current.inputs &&\n      areInputsEqual(inputs, committed.current.inputs),\n  );\n\n  // create a new cache if required\n  const cache = isInputMatch\n    ? committed.current\n    : {\n        inputs,\n        result: getResult(),\n      };\n\n  // commit the cache\n  React.useEffect(() => {\n    committed.current = cache;\n  }, [cache]);\n\n  return cache.result;\n}\n","import { isDraft, original } from 'immer';\nimport { createSimpleProduce, get } from './lib';\n\nexport default function createReducer(disableImmer, _aRD, _cR, _cP) {\n  const simpleProduce = createSimpleProduce(disableImmer);\n\n  const runActionReducerAtPath = (state, action, actionReducer, path, config) =>\n    simpleProduce(path, state, (draft) => actionReducer(draft, action.payload), config);\n\n  const reducerForActions = (state, action) => {\n    const actionReducer = _aRD[action.type];\n    if (actionReducer) {\n      return runActionReducerAtPath(\n        state,\n        action,\n        actionReducer,\n        actionReducer.def.meta.parent,\n        actionReducer.def.config,\n      );\n    }\n    return state;\n  };\n\n  const reducerForCustomReducers = (state, action) =>\n    _cR.reduce(\n      (acc, { parentPath, key, reducer, config }) =>\n        simpleProduce(parentPath, acc, (draft) => {\n          draft[key] = reducer(\n            isDraft(draft[key]) ? original(draft[key]) : draft[key],\n            action,\n          );\n          return draft;\n        }, config),\n      state,\n    );\n\n  const rootReducer = (state, action) => {\n    const stateAfterActions = reducerForActions(state, action);\n    const next =\n      _cR.length > 0\n        ? reducerForCustomReducers(stateAfterActions, action)\n        : stateAfterActions;\n    if (state !== next) {\n      _cP.forEach(({ parentPath, bindComputedProperty }) => {\n        const parentState = get(parentPath, next);\n        if (parentState != null) bindComputedProperty(parentState, next);\n      });\n    }\n    return next;\n  };\n\n  return rootReducer;\n}\n","import { clone, get, isPlainObject, isPromise, set, pSeries } from './lib';\n\nconst noopStorage = {\n  getItem: () => undefined,\n  setItem: () => undefined,\n  removeItem: () => undefined,\n};\n\nconst getBrowerStorage = (storageName) => {\n  let storageCache;\n  return () => {\n    if (!storageCache) {\n      try {\n        if (\n          typeof window !== 'undefined' &&\n          typeof window[storageName] !== 'undefined'\n        ) {\n          storageCache = window[storageName];\n        }\n      } catch (_) {\n        // swallow the failure\n      }\n      if (!storageCache) {\n        storageCache = noopStorage;\n      }\n    }\n\n    return storageCache;\n  };\n};\n\nconst localStorage = getBrowerStorage('localStorage');\nconst sessionStorage = getBrowerStorage('sessionStorage');\n\nfunction createStorageWrapper(storage, transformers = []) {\n  if (storage == null) {\n    storage = sessionStorage();\n  }\n\n  if (typeof storage === 'string') {\n    if (storage === 'localStorage') {\n      storage = localStorage();\n    } else if (storage === 'sessionStorage') {\n      storage = sessionStorage();\n    } else {\n      if (process.env.NODE_ENV === 'development') {\n        // eslint-disable-next-line no-console\n        console.warn(`Invalid storage provider`);\n      }\n      storage = noopStorage;\n    }\n  }\n\n  const outTransformers = [...transformers].reverse();\n\n  const serialize = (data) => {\n    if (transformers.length > 0 && data != null && typeof data === 'object') {\n      Object.keys(data).forEach((key) => {\n        data[key] = transformers.reduce(\n          (acc, cur) => cur.in(acc, key),\n          data[key],\n        );\n      });\n    }\n\n    return storage === localStorage() || storage === sessionStorage()\n      ? JSON.stringify({ data })\n      : data;\n  };\n\n  const deserialize = (data) => {\n    const result =\n      storage === localStorage() || storage === sessionStorage()\n        ? JSON.parse(data).data\n        : data;\n    if (\n      outTransformers.length > 0 &&\n      result != null &&\n      typeof result === 'object'\n    ) {\n      Object.keys(result).forEach((key) => {\n        result[key] = outTransformers.reduce(\n          (acc, cur) => cur.out(acc, key),\n          result[key],\n        );\n      });\n    }\n    return result;\n  };\n\n  const isAsync = isPromise(storage.getItem('_'));\n\n  return {\n    getItem: (key) => {\n      if (isAsync) {\n        return storage\n          .getItem(key)\n          .then((wrapped) =>\n            wrapped != null ? deserialize(wrapped) : undefined,\n          );\n      }\n      const wrapped = storage.getItem(key);\n      return wrapped != null ? deserialize(wrapped) : undefined;\n    },\n    setItem: (key, data) => storage.setItem(key, serialize(data)),\n    removeItem: (key) => storage.removeItem(key),\n  };\n}\n\nexport function extractPersistConfig(path, persistdef = {}) {\n  return {\n    path,\n    config: {\n      allow: persistdef.allow || [],\n      deny: persistdef.deny || [],\n      mergeStrategy: persistdef.mergeStrategy || 'mergeDeep',\n      storage: createStorageWrapper(\n        persistdef.storage,\n        persistdef.transformers,\n      ),\n    },\n  };\n}\n\nfunction resolvePersistTargets(target, allow, deny) {\n  let targets = Object.keys(target);\n  if (allow.length > 0) {\n    targets = targets.reduce((acc, cur) => {\n      if (allow.findIndex((x) => x === cur) !== -1) {\n        return [...acc, cur];\n      }\n      return acc;\n    }, []);\n  }\n  if (deny.length > 0) {\n    targets = targets.reduce((acc, cur) => {\n      if (deny.findIndex((x) => x === cur) !== -1) {\n        return acc;\n      }\n      return [...acc, cur];\n    }, []);\n  }\n  return targets;\n}\n\nfunction createPersistenceClearer(persistKey, _r) {\n  return () => {\n    if (_r._i._persistenceConfig.length === 0) {\n      return Promise.resolve();\n    }\n    return pSeries(\n      _r._i._persistenceConfig.map(\n        ({ path, config }) =>\n          () =>\n            Promise.resolve(config.storage.removeItem(persistKey(path))),\n      ),\n    );\n  };\n}\n\nexport function createPersistor(persistKey, _r) {\n  let persistPromise = Promise.resolve();\n  let isPersisting = false;\n  let nextPersistOperation;\n\n  const timingMethod =\n    typeof window === 'undefined'\n      ? (fn) => fn()\n      : window.requestIdleCallback != null\n      ? window.requestIdleCallback\n      : window.requestAnimationFrame;\n\n  const persist = (nextState) => {\n    if (_r._i._persistenceConfig.length === 0) {\n      return;\n    }\n\n    const operation = () => {\n      isPersisting = true;\n      persistPromise = new Promise((resolve) => {\n        timingMethod(() => {\n          pSeries(\n            _r._i._persistenceConfig.map(({ path, config }) => () => {\n              const { storage, allow, deny } = config;\n              const persistRootState = clone(get(path, nextState));\n              const persistTargets = resolvePersistTargets(\n                persistRootState,\n                allow,\n                deny,\n              );\n              const stateToPersist = {};\n              persistTargets.map((key) => {\n                const targetPath = [...path, key];\n                const rawValue = get(targetPath, nextState);\n                const value = isPlainObject(rawValue)\n                  ? clone(rawValue)\n                  : rawValue;\n                stateToPersist[key] = value;\n              });\n              return Promise.resolve(\n                storage.setItem(persistKey(path), stateToPersist),\n              );\n            }),\n          ).finally(() => {\n            isPersisting = false;\n            if (nextPersistOperation) {\n              const next = nextPersistOperation;\n              nextPersistOperation = null;\n              next();\n            } else {\n              resolve();\n            }\n          });\n        });\n      });\n    };\n\n    if (isPersisting) {\n      nextPersistOperation = operation;\n    } else {\n      operation();\n    }\n  };\n\n  return {\n    persist,\n    clear: createPersistenceClearer(persistKey, _r),\n    flush: () => {\n      if (nextPersistOperation) {\n        nextPersistOperation();\n      }\n      return persistPromise;\n    },\n  };\n}\n\nexport function createPersistMiddleware(persistor, _r) {\n  return ({ getState }) =>\n    (next) =>\n    (action) => {\n      const state = next(action);\n      if (\n        action &&\n        action.type !== '@action.ePRS' &&\n        _r._i._persistenceConfig.length > 0\n      ) {\n        persistor.persist(getState());\n      }\n      return state;\n    };\n}\n\nexport function rehydrateStateFromPersistIfNeeded(\n  persistKey,\n  replaceState,\n  _r,\n  root,\n) {\n  if (_r._i._persistenceConfig.length === 0) {\n    return Promise.resolve();\n  }\n\n  const state = clone(_r._i._dS);\n\n  let rehydrating = false;\n\n  return pSeries(\n    _r._i._persistenceConfig.map((persistInstance) => () => {\n      const { path, config } = persistInstance;\n      const { mergeStrategy, storage } = config;\n\n      if (root && (path.length < 1 || path[0] !== root)) {\n        return Promise.resolve();\n      }\n\n      const hasDataModelChanged = (dataModel, rehydratingModelData) =>\n        dataModel != null &&\n        rehydratingModelData != null &&\n        (typeof dataModel !== typeof rehydratingModelData ||\n          (Array.isArray(dataModel) && !Array.isArray(rehydratingModelData)));\n\n      const applyRehydrationStrategy = (persistedState) => {\n        if (mergeStrategy === 'overwrite') {\n          set(path, state, persistedState);\n        } else if (mergeStrategy === 'mergeShallow') {\n          const targetState = get(path, state);\n          Object.keys(persistedState).forEach((key) => {\n            if (hasDataModelChanged(targetState[key], persistedState[key])) {\n              // skip as the data model type has changed since the data was persisted\n            } else {\n              targetState[key] = persistedState[key];\n            }\n          });\n        } else if (mergeStrategy === 'mergeDeep') {\n          const targetState = get(path, state);\n          const setAt = (currentTargetState, currentPersistedState) => {\n            Object.keys(currentPersistedState).forEach((key) => {\n              if (\n                hasDataModelChanged(\n                  currentTargetState[key],\n                  currentPersistedState[key],\n                )\n              ) {\n                // skip as the data model type has changed since the data was persisted\n              } else if (isPlainObject(currentPersistedState[key])) {\n                currentTargetState[key] = currentTargetState[key] || {};\n                setAt(currentTargetState[key], currentPersistedState[key]);\n              } else {\n                currentTargetState[key] = currentPersistedState[key];\n              }\n            });\n          };\n          setAt(targetState, persistedState);\n        }\n      };\n\n      const rehydate = (persistedState) => {\n        if (persistedState != null) {\n          applyRehydrationStrategy(persistedState);\n          rehydrating = true;\n        }\n      };\n\n      const getItemResult = storage.getItem(persistKey(path));\n      if (isPromise(getItemResult)) {\n        return getItemResult.then(rehydate);\n      }\n      return Promise.resolve(rehydate(getItemResult));\n    }),\n  ).then(() => {\n    if (rehydrating) {\n      replaceState(state);\n    }\n  });\n}\n","import { actionOnSymbol } from './constants';\n\nexport function createActionCreator(def, _r) {\n  function actionCreator(payload) {\n    const action = {\n      type: def.meta.type,\n      payload,\n      config: def.config,\n    };\n    if (def[actionOnSymbol] && def.meta.resolvedTargets) {\n      payload.resolvedTargets = [...def.meta.resolvedTargets];\n    }\n    return _r.dispatch(action);\n  }\n\n  // We bind the types to the creator for easy reference by consumers\n  actionCreator.type = def.meta.type;\n\n  return actionCreator;\n}\n","import { thunkOnSymbol } from './constants';\nimport { get, isPromise } from './lib';\n\nexport function createThunkHandler(def, _r, injections, _aC) {\n  return (payload, fail) => {\n    const helpers = {\n      dispatch: _r.dispatch,\n      fail,\n      getState: () => get(def.meta.parent, _r.getState()),\n      getStoreActions: () => _aC,\n      getStoreState: _r.getState,\n      injections,\n      meta: {\n        key: def.meta.actionName,\n        parent: def.meta.parent,\n        path: def.meta.path,\n      },\n    };\n    if (def[thunkOnSymbol] && def.meta.resolvedTargets) {\n      payload.resolvedTargets = [...def.meta.resolvedTargets];\n    }\n    return def.fn(get(def.meta.parent, _aC), payload, helpers);\n  };\n}\n\nconst logThunkEventListenerError = (type, err) => {\n  // eslint-disable-next-line no-console\n  console.log(`Error in ${type}`);\n  // eslint-disable-next-line no-console\n  console.log(err);\n};\n\nconst handleEventDispatchErrors =\n  (type, dispatcher) =>\n  (...args) => {\n    try {\n      const result = dispatcher(...args);\n      if (isPromise(result)) {\n        result.catch((err) => {\n          logThunkEventListenerError(type, err);\n        });\n      }\n    } catch (err) {\n      logThunkEventListenerError(type, err);\n    }\n  };\n\nexport function createThunkActionsCreator(def, _r) {\n  const actionCreator = (payload) => {\n    const dispatchStart = handleEventDispatchErrors(def.meta.startType, () =>\n      _r.dispatch({\n        type: def.meta.startType,\n        payload,\n      }),\n    );\n\n    const dispatchFail = handleEventDispatchErrors(def.meta.failType, (err) =>\n      _r.dispatch({\n        type: def.meta.failType,\n        payload,\n        error: err,\n      }),\n    );\n\n    const dispatchSuccess = handleEventDispatchErrors(\n      def.meta.successType,\n      (result) =>\n        _r.dispatch({\n          type: def.meta.successType,\n          payload,\n          result,\n        }),\n    );\n\n    dispatchStart();\n\n    let failure = null;\n\n    const fail = (_failure) => {\n      failure = _failure;\n    };\n\n    const result = _r.dispatch(() => def.thunkHandler(payload, fail));\n\n    if (isPromise(result)) {\n      return result.then((resolved) => {\n        if (failure) {\n          dispatchFail(failure);\n        } else {\n          dispatchSuccess(resolved);\n        }\n        return resolved;\n      });\n    }\n\n    if (failure) {\n      dispatchFail(failure);\n    } else {\n      dispatchSuccess(result);\n    }\n\n    return result;\n  };\n\n  actionCreator.type = def.meta.type;\n  actionCreator.successType = def.meta.successType;\n  actionCreator.failType = def.meta.failType;\n  actionCreator.startType = def.meta.startType;\n\n  return actionCreator;\n}\n","import { get } from './lib';\n\nexport function createListenerMiddleware(_r) {\n  return () => (next) => (action) => {\n    const result = next(action);\n    if (\n      action &&\n      _r._i._lAM[action.type] &&\n      _r._i._lAM[action.type].length > 0\n    ) {\n      const sourceAction = _r._i._aCD[action.type];\n      _r._i._lAM[action.type].forEach((actionCreator) => {\n        actionCreator({\n          type: sourceAction ? sourceAction.def.meta.type : action.type,\n          payload: action.payload,\n          error: action.error,\n          result: action.result,\n        });\n      });\n    }\n    return result;\n  };\n}\n\nexport function bindListenerdefs(listenerdefs, _aC, _aCD, _lAM) {\n  listenerdefs.forEach((def) => {\n    const targets = def.targetResolver(get(def.meta.parent, _aC), _aC);\n\n    const targetTypes = (Array.isArray(targets) ? targets : [targets]).reduce(\n      (acc, target) => {\n        if (\n          typeof target === 'function' &&\n          target.def.meta.type &&\n          _aCD[target.def.meta.type]\n        ) {\n          if (target.def.meta.successType) {\n            acc.push(target.def.meta.successType);\n          } else {\n            acc.push(target.def.meta.type);\n          }\n        } else if (typeof target === 'string') {\n          acc.push(target);\n        }\n        return acc;\n      },\n      [],\n    );\n\n    def.meta.resolvedTargets = targetTypes;\n\n    targetTypes.forEach((targetType) => {\n      const listenerReg = _lAM[targetType] || [];\n      listenerReg.push(_aCD[def.meta.type]);\n      _lAM[targetType] = listenerReg;\n    });\n  });\n}\n","import equal from 'fast-deep-equal/es6';\nimport { areInputsEqual } from './lib';\n\nexport function createComputedPropertyBinder(parentPath, key, def, _r) {\n  let runOnce = false;\n  let prevInputs = [];\n  let prevValue;\n  let prevStoreState;\n\n  let performingEqualityCheck = false;\n\n  const areEqual = (a, b) => {\n    performingEqualityCheck = true;\n    const result = equal(a, b);\n    performingEqualityCheck = false;\n    return result;\n  };\n\n  return function createComputedProperty(parentState, storeState) {\n    Object.defineProperty(parentState, key, {\n      configurable: true,\n      enumerable: true,\n      get: () => {\n        if (performingEqualityCheck) {\n          return prevValue;\n        }\n\n        const inputs = def.stateResolvers.map((resolver) =>\n          resolver(parentState, storeState),\n        );\n        if (\n          runOnce &&\n          (storeState === prevStoreState ||\n            areInputsEqual(inputs, prevInputs) ||\n            // We don't want computed properties resolved every time an action\n            // is handled by the reducer. They need to remain lazy, only being\n            // computed when used by a component or getState call;\n            (_r._i._cS.isInReducer &&\n              // This is to account for strange errors that may occur via immer;\n              new Error().stack.match(/shallowCopy/gi) !== null))\n        ) {\n          return prevValue;\n        }\n\n        const newValue = def.fn(...inputs);\n        if (!areEqual(newValue, prevValue)) {\n          prevValue = newValue;\n        }\n\n        prevInputs = inputs;\n        prevStoreState = storeState;\n        runOnce = true;\n        return prevValue;\n      },\n    });\n  };\n}\n\nexport function createComputedPropertiesMiddleware(_r) {\n  return () => (next) => (action) => {\n    _r._i._cS.isInReducer = true;\n    const result = next(action);\n    _r._i._cS.isInReducer = false;\n    return result;\n  };\n}\n","import { get, isPromise } from './lib';\n\nexport function createEffectsMiddleware(_r) {\n  return (store) => (next) => (action) => {\n    if (_r._i._e.length === 0) {\n      return next(action);\n    }\n    const prevState = store.getState();\n    const result = next(action);\n    const nextState = store.getState();\n    if (prevState !== nextState) {\n      _r._i._e.forEach((def) => {\n        const prevLocal = get(def.meta.parent, prevState);\n        const nextLocal = get(def.meta.parent, nextState);\n        const prevDependencies = def.dependencyResolvers.map((resolver) =>\n          resolver(prevLocal, prevState),\n        );\n        const nextDependencies = def.dependencyResolvers.map((resolver) =>\n          resolver(nextLocal, nextState),\n        );\n        const hasChanged = prevDependencies.some(\n          (dependency, idx) => dependency !== nextDependencies[idx],\n        );\n        if (hasChanged) {\n          def.actionCreator(prevDependencies, nextDependencies, action);\n        }\n      });\n    }\n    return result;\n  };\n}\n\nconst logEffectError = (err) => {\n  // As users can't get a handle on effects we need to report the error\n  // eslint-disable-next-line no-console\n  console.error(err);\n};\n\nexport function createEffectHandler(def, _r, injections, _aC) {\n  const actions = get(def.meta.parent, _aC);\n\n  let dispose;\n\n  return (change) => {\n    const helpers = {\n      dispatch: _r.dispatch,\n      getState: () => get(def.meta.parent, _r.getState()),\n      getStoreActions: () => _aC,\n      getStoreState: _r.getState,\n      injections,\n      meta: {\n        key: def.meta.actionName,\n        parent: def.meta.parent,\n        path: def.meta.path,\n      },\n    };\n\n    if (dispose !== undefined) {\n      const disposeResult = dispose();\n      dispose = undefined;\n      if (isPromise(disposeResult)) {\n        disposeResult.catch(logEffectError);\n      }\n    }\n\n    const effectResult = def.fn(actions, change, helpers);\n\n    if (isPromise(effectResult)) {\n      return effectResult.then((resolved) => {\n        if (typeof resolved === 'function') {\n          if (process.env.NODE_ENV !== 'production') {\n            // Dispose functions are not allowed to be resolved asynchronously.\n            // Doing so would provide inconsistent behaviour around their execution.\n            // eslint-disable-next-line no-console\n            console.warn(\n              '[easy-peasy] Effect is asynchronously resolving a dispose fn.',\n            );\n          }\n        }\n      });\n    }\n\n    if (typeof effectResult === 'function') {\n      dispose = effectResult;\n    }\n\n    return undefined;\n  };\n}\n\nconst logEffectEventListenerError = (type, err) => {\n  // eslint-disable-next-line no-console\n  console.log(`Error in ${type}`);\n  // eslint-disable-next-line no-console\n  console.log(err);\n};\n\nconst handleEventDispatchErrors =\n  (type, dispatcher) =>\n  (...args) => {\n    try {\n      const result = dispatcher(...args);\n      if (isPromise(result)) {\n        result.catch((err) => {\n          logEffectEventListenerError(type, err);\n        });\n      }\n    } catch (err) {\n      logEffectEventListenerError(type, err);\n    }\n  };\n\nexport function createEffectActionsCreator(def, _r, effectHandler) {\n  const actionCreator = (previousDependencies, nextDependencies, action) => {\n    const change = {\n      prev: previousDependencies,\n      current: nextDependencies,\n      action,\n    };\n\n    const dispatchStart = handleEventDispatchErrors(def.meta.startType, () =>\n      _r.dispatch({\n        type: def.meta.startType,\n        change,\n      }),\n    );\n\n    const dispatchSuccess = handleEventDispatchErrors(\n      def.meta.successType,\n      () =>\n        _r.dispatch({\n          type: def.meta.successType,\n          change,\n        }),\n    );\n\n    dispatchStart();\n\n    try {\n      const result = _r.dispatch(() => effectHandler(change));\n\n      if (isPromise(result)) {\n        return result.then((resolved) => {\n          dispatchSuccess(resolved);\n          return resolved;\n        }, logEffectError);\n      }\n\n      dispatchSuccess(result);\n\n      return result;\n    } catch (err) {\n      logEffectError(err);\n    }\n\n    return undefined;\n  };\n\n  actionCreator.type = def.meta.type;\n  actionCreator.startType = def.meta.startType;\n  actionCreator.successType = def.meta.successType;\n  actionCreator.failType = def.meta.failType;\n\n  return actionCreator;\n}\n\n","import {\n  actionOnSymbol,\n  actionSymbol,\n  computedSymbol,\n  effectOnSymbol,\n  persistSymbol,\n  reducerSymbol,\n  thunkOnSymbol,\n  thunkSymbol,\n} from './constants';\nimport { get, isPlainObject, set } from './lib';\nimport { extractPersistConfig } from './persistence';\nimport { createActionCreator } from './actions';\nimport { createThunkHandler, createThunkActionsCreator } from './thunks';\nimport { bindListenerdefs } from './listeners';\nimport { createComputedPropertyBinder } from './computed-properties';\nimport { createEffectHandler, createEffectActionsCreator } from './effects';\n\nexport default function extractDataFromModel(\n  model,\n  initialState,\n  injections,\n  _r,\n) {\n  const _dS = initialState;\n  const _aCD = {};\n  const _aC = {};\n  const _aRD = {};\n  const actionThunks = {};\n  const _cP = [];\n  const _cR = [];\n  const _e = [];\n  const _lAC = {};\n  const _lAM = {};\n  const listenerdefs = [];\n  let _persistenceConfig = [];\n  const _cS = {\n    isInReducer: false,\n  };\n\n  const recursiveExtractFromModel = (current, parentPath) =>\n    Object.keys(current).forEach((key) => {\n      const value = current[key];\n      const path = [...parentPath, key];\n      const meta = {\n        parent: parentPath,\n        path,\n        key,\n      };\n      const handleValueAsState = () => {\n        const initialParentRef = get(parentPath, initialState);\n        if (initialParentRef && key in initialParentRef) {\n          set(path, _dS, initialParentRef[key]);\n        } else {\n          set(path, _dS, value);\n        }\n      };\n\n      if (key === persistSymbol) {\n        _persistenceConfig.push(extractPersistConfig(parentPath, value));\n        return;\n      }\n\n      if (value != null && typeof value === 'object') {\n        if (value[actionSymbol] || value[actionOnSymbol]) {\n          const def = { ...value };\n\n          // Determine the category of the action\n          const category = def[actionSymbol] ? '@action' : '@actionOn';\n\n          // Establish the meta data describing the action\n          def.meta = {\n            actionName: meta.key,\n            category,\n            type: `${category}.${meta.path.join('.')}`,\n            parent: meta.parent,\n            path: meta.path,\n          };\n\n          // Create the \"action creator\" function\n          def.actionCreator = createActionCreator(def, _r);\n\n          // Create a bidirectional relationship of the def/actionCreator\n          def.actionCreator.def = def;\n\n          // Create a bidirectional relationship of the def/reducer\n          def.fn.def = def;\n\n          // Add the action creator to lookup map\n          _aCD[def.meta.type] = def.actionCreator;\n\n          // Add the reducer to lookup map\n          _aRD[def.meta.type] = def.fn;\n\n          // We don't want to expose the internal action to consumers\n          if (meta.key !== 'ePRS') {\n            // Set the action creator in the \"actions\" object tree for\n            // either the listeners object tree, or the standard actions/thunks\n            // object tree\n            if (def[actionOnSymbol]) {\n              listenerdefs.push(def);\n              set(path, _lAC, def.actionCreator);\n            } else {\n              set(path, _aC, def.actionCreator);\n            }\n          }\n        } else if (value[thunkSymbol] || value[thunkOnSymbol]) {\n          const def = { ...value };\n\n          // Determine the category of the thunk\n          const category = def[thunkSymbol] ? '@thunk' : '@thunkOn';\n\n          // Establish the meta data describing the thunk\n          const type = `${category}.${meta.path.join('.')}`;\n          def.meta = {\n            actionName: meta.key,\n            parent: meta.parent,\n            path: meta.path,\n            type,\n            startType: `${type}(start)`,\n            successType: `${type}(success)`,\n            failType: `${type}(fail)`,\n          };\n\n          // Create the function that will handle, i.e. be executed, when\n          // the thunk action is created/dispatched\n          def.thunkHandler = createThunkHandler(def, _r, injections, _aC);\n\n          // Register the thunk handler\n          set(path, actionThunks, def.thunkHandler);\n\n          // Create the \"action creator\" function\n          def.actionCreator = createThunkActionsCreator(def, _r);\n\n          // Create a bidirectional relationship of the def/actionCreator\n          def.actionCreator.def = def;\n\n          // Register the action creator within the lookup map\n          _aCD[def.meta.type] = def.actionCreator;\n\n          // Set the action creator in the \"actions\" object tree for\n          // either the listeners object tree, or the standard actions/thunks\n          // object tree\n          if (def[thunkOnSymbol]) {\n            listenerdefs.push(def);\n            set(path, _lAC, def.actionCreator);\n          } else {\n            set(path, _aC, def.actionCreator);\n          }\n        } else if (value[computedSymbol]) {\n          const parent = get(parentPath, _dS);\n          const bindComputedProperty = createComputedPropertyBinder(\n            parentPath,\n            key,\n            value,\n            _r,\n          );\n          bindComputedProperty(parent, _dS);\n          _cP.push({ key, parentPath, bindComputedProperty });\n        } else if (value[reducerSymbol]) {\n          _cR.push({ key, parentPath, reducer: value.fn, config: value.config });\n        } else if (value[effectOnSymbol]) {\n          const def = { ...value };\n\n          // Establish the meta data describing the effect\n          const type = `@effectOn.${meta.path.join('.')}`;\n          def.meta = {\n            type,\n            actionName: meta.key,\n            parent: meta.parent,\n            path: meta.path,\n            startType: `${type}(start)`,\n            successType: `${type}(success)`,\n            failType: `${type}(fail)`,\n          };\n\n          const effectHandler = createEffectHandler(def, _r, injections, _aC);\n\n          const actionCreator = createEffectActionsCreator(\n            def,\n            _r,\n            effectHandler,\n          );\n\n          def.actionCreator = actionCreator;\n\n          _e.push(def);\n        } else if (isPlainObject(value)) {\n          const existing = get(path, _dS);\n          if (existing == null) {\n            set(path, _dS, {});\n          }\n          recursiveExtractFromModel(value, path);\n        } else {\n          handleValueAsState();\n        }\n      } else {\n        handleValueAsState();\n      }\n    });\n\n  _persistenceConfig = _persistenceConfig.sort((a, b) => {\n    const aPath = a.path.join('.');\n    const bPath = b.path.join('.');\n    if (aPath < bPath) {\n      return -1;\n    }\n    if (aPath > bPath) {\n      return 1;\n    }\n    return 0;\n  });\n\n  recursiveExtractFromModel(model, []);\n\n  bindListenerdefs(listenerdefs, _aC, _aCD, _lAM);\n\n  return {\n    _aCD,\n    _aC,\n    _aRD,\n    _cP,\n    _cR,\n    _cS,\n    _dS,\n    _e,\n    _lAC,\n    _lAM,\n    _persistenceConfig,\n  };\n}\n","import {\n  applyMiddleware,\n  compose as reduxCompose,\n  createStore as reduxCreateStore,\n} from 'redux';\nimport reduxThunk from 'redux-thunk';\nimport * as helpers from './helpers';\nimport createReducer from './create-reducer';\nimport extractDataFromModel from './extract-data-from-model';\nimport {\n  createPersistor,\n  createPersistMiddleware,\n  rehydrateStateFromPersistIfNeeded,\n} from './persistence';\nimport { createComputedPropertiesMiddleware } from './computed-properties';\nimport { createListenerMiddleware } from './listeners';\nimport { clone } from './lib';\nimport { createEffectsMiddleware } from './effects';\n\nexport function createStore(model, options = {}) {\n  const modelClone = clone(model);\n  const {\n    compose,\n    devTools = process.env.NODE_ENV !== 'production',\n    disableImmer = false,\n    enhancers = [],\n    initialState = undefined,\n    injections = {},\n    middleware = [],\n    mockActions = false,\n    name: storeName = `EasyPeasyStore`,\n    version = 0,\n    reducerEnhancer = (rootReducer) => rootReducer,\n  } = options;\n\n  const bindReplaceState = (modelDef) => ({\n    ...modelDef,\n    ePRS: helpers.action((_, payload) => payload),\n  });\n\n  const _r = {};\n\n  let modeldef = bindReplaceState(modelClone);\n  let mockedActions = [];\n\n  const persistKey = (targetPath) =>\n    `[${storeName}][${version}]${\n      targetPath.length > 0 ? `[${targetPath.join('.')}]` : ''\n    }`;\n  const persistor = createPersistor(persistKey, _r);\n  const persistMiddleware = createPersistMiddleware(persistor, _r);\n\n  const replaceState = (nextState) => _r._i._aCD['@action.ePRS'](nextState);\n\n  const bindStoreInternals = (state = {}) => {\n    const data = extractDataFromModel(modeldef, state, injections, _r);\n    _r._i = {\n      ...data,\n      reducer: reducerEnhancer(\n        createReducer(disableImmer, data._aRD, data._cR, data._cP),\n      ),\n    };\n  };\n\n  const mockActionsMiddleware = () => () => (action) => {\n    if (action != null) {\n      mockedActions.push(action);\n    }\n    return undefined;\n  };\n\n  const devToolConfig = devTools === true ? {} : devTools;\n\n  const composeEnhancers =\n    compose ||\n    (devTools &&\n    typeof window !== 'undefined' &&\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n          name: storeName,\n          ...devToolConfig,\n        })\n      : reduxCompose);\n\n  bindStoreInternals(initialState || {});\n\n  const easyPeasyMiddleware = [\n    createComputedPropertiesMiddleware(_r),\n    ...middleware,\n    reduxThunk,\n    createListenerMiddleware(_r),\n    createEffectsMiddleware(_r),\n    persistMiddleware,\n  ];\n\n  if (mockActions) {\n    easyPeasyMiddleware.push(mockActionsMiddleware);\n  }\n\n  const store = reduxCreateStore(\n    _r._i.reducer,\n    _r._i._dS,\n    composeEnhancers(applyMiddleware(...easyPeasyMiddleware), ...enhancers),\n  );\n\n  store.subscribe(() => {\n    _r._i._cS.isInReducer = false;\n  });\n\n  _r.dispatch = store.dispatch;\n  _r.getState = store.getState;\n\n  const bindActionCreators = () => {\n    Object.keys(store.dispatch).forEach((actionsKey) => {\n      delete store.dispatch[actionsKey];\n    });\n    Object.keys(_r._i._aC).forEach((key) => {\n      store.dispatch[key] = _r._i._aC[key];\n    });\n  };\n\n  bindActionCreators();\n\n  const rebindStore = (removeKey) => {\n    const currentState = store.getState();\n    if (removeKey) {\n      delete currentState[removeKey];\n    }\n    bindStoreInternals(currentState);\n    store.replaceReducer(_r._i.reducer);\n    replaceState(_r._i._dS);\n    bindActionCreators();\n  };\n\n  const resolveRehydration = rehydrateStateFromPersistIfNeeded(\n    persistKey,\n    replaceState,\n    _r,\n  );\n\n  return Object.assign(store, {\n    addModel: (key, modelForKey) => {\n      if (modeldef[key] && process.env.NODE_ENV !== 'production') {\n        store.removeModel(key);\n      }\n      modeldef[key] = modelForKey;\n      rebindStore();\n      // There may have been persisted state for a dynamic model. We should try\n      // and rehydrate the specifc node\n      const addModelRehydration = rehydrateStateFromPersistIfNeeded(\n        persistKey,\n        replaceState,\n        _r,\n        key,\n      );\n      return {\n        resolveRehydration: () => addModelRehydration,\n      };\n    },\n    clearMockedActions: () => {\n      mockedActions = [];\n    },\n    getActions: () => _r._i._aC,\n    getListeners: () => _r._i._lAC,\n    getMockedActions: () => [...mockedActions],\n    getServerState: initialState,\n    persist: {\n      clear: persistor.clear,\n      flush: persistor.flush,\n      resolveRehydration: () => resolveRehydration,\n    },\n    reconfigure: (newModel) => {\n      modeldef = bindReplaceState(newModel);\n      rebindStore();\n    },\n    removeModel: (key) => {\n      if (!modeldef[key]) {\n        return;\n      }\n      delete modeldef[key];\n      rebindStore(key);\n    },\n  });\n}\n","/* eslint-disable react/prop-types */\n\nimport React, { createContext, useContext } from 'react';\nimport {\n  createStoreActionsHook,\n  createStoreDispatchHook,\n  createStoreStateHook,\n  createStoreRehydratedHook,\n} from './hooks';\nimport { createStore } from './create-store';\nimport { useMemoOne } from './lib';\n\nexport function createContextStore(model, config = {}) {\n  // We create a mutable injections reference to allow updating it\n  const { injections: mutableInjections = {} } = config;\n\n  const StoreContext = createContext();\n\n  function Provider({ children, runtimeModel, injections }) {\n    // If the user provided injections we need to ensure our mutable ref\n    // is up to date. We could consider doing a shallow compare here?\n    if (injections != null) {\n      const nextInjections =\n        typeof injections === 'function'\n          ? injections(mutableInjections)\n          : injections;\n      const nextKeys = Object.keys(nextInjections);\n      const removeKeys = Object.keys(mutableInjections).filter(\n        (k) => !nextKeys.includes(k),\n      );\n      removeKeys.forEach((k) => {\n        delete mutableInjections[k];\n      });\n      Object.assign(mutableInjections, nextInjections);\n    }\n\n    const store = useMemoOne(\n      () =>\n        createStore(typeof model === 'function' ? model(runtimeModel) : model, {\n          ...config,\n          originalInjections: mutableInjections,\n        }),\n      [],\n    );\n    return (\n      <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n    );\n  }\n\n  function useStore() {\n    return useContext(StoreContext);\n  }\n\n  return {\n    Provider,\n    useStore,\n    useStoreState: createStoreStateHook(StoreContext),\n    useStoreActions: createStoreActionsHook(StoreContext),\n    useStoreDispatch: createStoreDispatchHook(StoreContext),\n    useStoreRehydrated: createStoreRehydratedHook(StoreContext),\n  };\n}\n","/**\n * This file has been copied from redux-persist.\n * The intention being to support as much of the redux-persist API as possible.\n */\n\nexport function createTransform(inbound, outbound, config = {}) {\n  const whitelist = config.whitelist || null;\n  const blacklist = config.blacklist || null;\n\n  function whitelistBlacklistCheck(key) {\n    if (whitelist && whitelist.indexOf(key) === -1) return true;\n    if (blacklist && blacklist.indexOf(key) !== -1) return true;\n    return false;\n  }\n\n  return {\n    in: (data, key, fullState) =>\n      !whitelistBlacklistCheck(key) && inbound\n        ? inbound(data, key, fullState)\n        : data,\n    out: (data, key, fullState) =>\n      !whitelistBlacklistCheck(key) && outbound\n        ? outbound(data, key, fullState)\n        : data,\n  };\n}\n","/* eslint-disable react/prop-types */\n\nimport React from 'react';\nimport StoreContext from './context';\n\nexport function StoreProvider({ children, store }) {\n  return (\n    <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n  );\n}\n","import { useEffect, useRef, useState } from 'react';\nimport { useMemoOne } from './lib';\nimport { createStore } from './create-store';\n\nexport function useLocalStore(\n  modelCreator,\n  dependencies = [],\n  configCreator = null,\n) {\n  const storeRef = useRef();\n\n  const configRef = useRef();\n\n  const store = useMemoOne(() => {\n    const previousState =\n      storeRef.current != null ? storeRef.current.getState() : undefined;\n    const config =\n      configCreator != null\n        ? configCreator(previousState, configRef.current)\n        : undefined;\n    const _store = createStore(modelCreator(previousState), config);\n    configRef.current = config;\n    storeRef.current = _store;\n    return _store;\n  }, dependencies);\n\n  const [currentState, setCurrentState] = useState(() => store.getState());\n\n  useEffect(() => {\n    setCurrentState(store.getState());\n    store.subscribe(() => {\n      const nextState = store.getState();\n      if (currentState !== nextState) {\n        setCurrentState(nextState);\n      }\n    });\n  }, [store]);\n\n  return [currentState, store.getActions(), store];\n}\n","// React 18 requires the use of the useSyncExternalStore hook for external\n// stores to hook into its concurrent features. We want to continue supporting\n// older versions of React (16/17), so we are utilsing a shim provided by the\n// React team which will ensure backwards compatibility;\n// eslint-disable-next-line import/no-unresolved\nimport { useSyncExternalStoreWithSelector } from 'use-sync-external-store/shim/with-selector';\n\nimport { initializeUseStoreState } from './hooks';\n\ninitializeUseStoreState(useSyncExternalStoreWithSelector);\n\nexport * from './hooks';\nexport * from './create-store';\nexport * from './create-context-store';\nexport * from './create-transform';\nexport * from './provider';\nexport * from './use-local-store';\nexport * from './helpers';\n"],"names":["StoreContext","createContext","useNotInitialized","Error","useSyncExternalStoreWithSelector","initializeUseStoreState","fn","refEquality","a","b","createStoreStateHook","Context","useStoreState","mapState","equalityFn","process","env","NODE_ENV","store","useContext","selectedState","subscribe","getState","getServerState","useDebugValue","EasyPeasyContext","createStoreActionsHook","useStoreActions","mapActions","getActions","createStoreDispatchHook","useStoreDispatch","dispatch","useStore","createStoreRehydratedHook","useStoreRehydrated","useState","rehydrated","setRehydrated","useEffect","persist","resolveRehydration","then","createTypedHooks","actionSymbol","actionOnSymbol","computedSymbol","effectOnSymbol","persistSymbol","reducerSymbol","thunkOnSymbol","thunkSymbol","debug","state","isDraft","current","actionOn","targetResolver","config","action","defaultStateResolvers","computed","fnOrStateResolvers","stateResolvers","unstable_effectOn","dependencyResolvers","generic","value","model","window","thunkOn","thunk","reducer","easyPeasyImmer","isPlainObject","obj","proto","Object","getPrototypeOf","clone","source","recursiveClone","next","keys","reduce","acc","key","getOwnPropertyDescriptor","get","forEach","isPromise","x","path","target","cur","undefined","newify","currentPath","currentState","finalValue","length","newState","slice","set","idx","createSimpleProduce","disableImmer","simpleProduce","immer","Immer","useProxies","Proxy","revocable","Reflect","autoFreeze","draft","createDraft","result","finishDraft","parentPath","parent","pReduce","iterable","initialValue","Promise","resolve","reject","iterator","Symbol","index","total","element","done","all","catch","err","pSeries","tasks","results","_","task","push","areInputsEqual","newInputs","lastInputs","i","useMemoOne","getResult","inputs","initial","React","committed","useRef","isInputMatch","Boolean","cache","createReducer","_aRD","_cR","_cP","runActionReducerAtPath","actionReducer","payload","reducerForActions","type","def","meta","reducerForCustomReducers","original","rootReducer","stateAfterActions","bindComputedProperty","parentState","noopStorage","getItem","setItem","removeItem","getBrowerStorage","storageName","storageCache","localStorage","sessionStorage","createStorageWrapper","storage","transformers","console","warn","outTransformers","reverse","serialize","data","in","JSON","stringify","deserialize","parse","out","isAsync","wrapped","extractPersistConfig","persistdef","allow","deny","mergeStrategy","resolvePersistTargets","targets","findIndex","createPersistenceClearer","persistKey","_r","_i","_persistenceConfig","map","createPersistor","persistPromise","isPersisting","nextPersistOperation","timingMethod","requestIdleCallback","requestAnimationFrame","nextState","operation","persistRootState","persistTargets","stateToPersist","targetPath","rawValue","finally","clear","flush","createPersistMiddleware","persistor","rehydrateStateFromPersistIfNeeded","replaceState","root","_dS","rehydrating","persistInstance","hasDataModelChanged","dataModel","rehydratingModelData","Array","isArray","applyRehydrationStrategy","persistedState","targetState","setAt","currentTargetState","currentPersistedState","rehydate","getItemResult","createActionCreator","actionCreator","resolvedTargets","createThunkHandler","injections","_aC","fail","helpers","getStoreActions","getStoreState","actionName","logThunkEventListenerError","log","handleEventDispatchErrors","dispatcher","createThunkActionsCreator","dispatchStart","startType","dispatchFail","failType","error","dispatchSuccess","successType","failure","_failure","thunkHandler","resolved","createListenerMiddleware","_lAM","sourceAction","_aCD","bindListenerdefs","listenerdefs","targetTypes","targetType","listenerReg","createComputedPropertyBinder","runOnce","prevInputs","prevValue","prevStoreState","performingEqualityCheck","areEqual","equal","createComputedProperty","storeState","defineProperty","configurable","enumerable","resolver","_cS","isInReducer","stack","match","newValue","createComputedPropertiesMiddleware","createEffectsMiddleware","_e","prevState","prevLocal","nextLocal","prevDependencies","nextDependencies","hasChanged","some","dependency","logEffectError","createEffectHandler","actions","dispose","change","disposeResult","effectResult","logEffectEventListenerError","createEffectActionsCreator","effectHandler","previousDependencies","prev","extractDataFromModel","initialState","actionThunks","_lAC","recursiveExtractFromModel","handleValueAsState","initialParentRef","category","join","existing","sort","aPath","bPath","createStore","options","modelClone","compose","devTools","enhancers","middleware","mockActions","name","storeName","version","reducerEnhancer","bindReplaceState","modelDef","ePRS","modeldef","mockedActions","persistMiddleware","bindStoreInternals","mockActionsMiddleware","devToolConfig","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reduxCompose","easyPeasyMiddleware","reduxThunk","reduxCreateStore","applyMiddleware","bindActionCreators","actionsKey","rebindStore","removeKey","replaceReducer","assign","addModel","modelForKey","removeModel","addModelRehydration","clearMockedActions","getListeners","getMockedActions","reconfigure","newModel","createContextStore","mutableInjections","Provider","children","runtimeModel","nextInjections","nextKeys","removeKeys","filter","k","includes","originalInjections","createTransform","inbound","outbound","whitelist","blacklist","whitelistBlacklistCheck","indexOf","fullState","StoreProvider","useLocalStore","modelCreator","dependencies","configCreator","storeRef","configRef","previousState","_store","setCurrentState"],"mappings":"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"}