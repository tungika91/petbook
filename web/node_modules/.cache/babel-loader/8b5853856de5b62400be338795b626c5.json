{"ast":null,"code":"var _jsxFileName = \"/Users/tungngo/Dropbox/Personal/Learning/React/petbook/src/context/DataContext.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { format } from 'date-fns';\nimport api from '../api/posts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DataContext = /*#__PURE__*/createContext({});\nexport const DataProvider = ({\n  children\n}) => {\n  _s();\n\n  const [pets, setPets] = useState([]);\n  /* default state is an array loaded from local storage or an empty array, in the event the database shoppinglist is deleted */\n\n  const [search, setSearch] = useState('');\n  const [searchResults, setSearchResults] = useState([]); // array of search results\n\n  const [picURL, setPicURL] = useState('');\n  const navigate = useNavigate(); // Inputs for Login\n\n  const [user, setUser] = useState('');\n  const [pwd, setPwd] = useState('');\n  const [userID, setUserID] = useState('');\n  const [auth, setAuth] = useState({}); // Inputs for Pet in POST\n\n  const [petName, setPetName] = useState('');\n  const [petType, setPetType] = useState('');\n  const [dob, setDob] = useState('');\n  const [deworm, setDeworm] = useState(format(new Date(), 'M-d-y'));\n  const [gender, setGender] = useState('');\n  const [ster, setSter] = useState('false');\n  const [petDesc, setPetDesc] = useState(''); // Inputs for Pet in PATCH\n\n  const [newPetName, setNewPetName] = useState(petName);\n  const [newPetType, setNewPetType] = useState(petType);\n  const [newDob, setNewDob] = useState(dob);\n  const [newDeworm, setNewDeworm] = useState(deworm);\n  const [newGender, setNewGender] = useState(gender);\n  const [newSter, setNewSter] = useState(ster);\n  const [newPetDesc, setNewPetDesc] = useState(petDesc); // ------------------- CREATE in CRUD ------------------- //\n\n  const addPet = async (petName, petType, dob, deworm, gender, ster, petDesc, userID) => {\n    const id = pets.length ? pets[pets.length - 1].id + 1 : 1; // to reference the last post --> posts[posts.length-1]\n\n    const isSterilised = ster.toLowerCase() === 'true';\n    const newPet = {\n      id,\n      pet_name: petName,\n      pet_type: petType,\n      pet_dob: dob,\n      pet_gender: gender,\n      last_deworm: deworm,\n      sterilised: isSterilised,\n      pet_description: petDesc,\n      user_id: userID\n    };\n\n    try {\n      const response = await api.post(`${userID}/pets/register`, newPet, {\n        headers: {\n          'x-access-token': auth.accessToken\n        }\n      });\n      console.log(response.data);\n      const allPets = [...pets, response.data]; // append new post to allPosts\n\n      setPets(allPets); // set Posts to allPosts\n\n      setPetName(''); // reset the setPostTitle and setPostBody to empty\n\n      setPetType('');\n      setDob('');\n      setDeworm(format(new Date(), 'M-d-y'));\n      setGender('');\n      setSter('false');\n      setPetDesc('');\n    } catch (err) {\n      console.log(`Error: ${err.message}`);\n    }\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    if (!petName) return;\n    addPet(petName, petType, dob, deworm, gender, ster, petDesc, userID); // addItem function\n\n    navigate('/'); // return to home page after submitting post\n  }; // ------------------- REQUEST in CRUD ------------------- //\n\n\n  useEffect(() => {\n    const fetchPets = async () => {\n      try {\n        // in axios, it automatically returns response in json format and catch the error, accesible through response.data\n        const response = await api.get(`${userID}/pets`, {\n          headers: {\n            'x-access-token': auth.accessToken\n          }\n        });\n        setPets(response.data); // response.data is in json format\n      } catch (err) {\n        if (err.response) {\n          // Not in the 200 response range\n          console.log(err.response.data);\n          console.log(err.response.status);\n          console.log(err.response.headers);\n        } else {\n          console.log(`Error: ${err.message}`);\n        }\n      }\n    };\n\n    const getPic = async id => {\n      try {\n        // in axios, it automatically returns response in json format and catch the error, accesible through response.data\n        const response = await api.get(`${userID}/pets/${id}/upload`, {\n          headers: {\n            'x-access-token': auth.accessToken\n          }\n        });\n        setPicURL(response); // response.data is in json format\n      } catch (err) {\n        if (err.response) {\n          // Not in the 200 response range\n          console.log(err.response.data);\n          console.log(err.response.status);\n          console.log(err.response.headers);\n        } else {\n          console.log(`Error: ${err.message}`);\n        }\n      }\n    };\n\n    fetchPets();\n    getPic();\n  }, [userID, auth]); // [] to show dependency so it won't infinitely request from server\n  // ------------------- UPDATE in CRUD ------------------- //\n\n  const handleEdit = async id => {\n    const updatePet = {\n      id,\n      pet_type: newPetType,\n      pet_dob: newDob,\n      pet_gender: newGender,\n      last_deworm: newDeworm,\n      sterilised: newSter.toLowerCase() === 'true',\n      pet_description: newPetDesc,\n      pet_name: newPetName\n    };\n\n    try {\n      const response = await api.patch(`${userID}/pets/${id}`, updatePet, {\n        headers: {\n          'x-access-token': auth.accessToken\n        }\n      });\n      console.log(response.data);\n      setPets(pets.map(pet => pet.id.toString() === id ? { ...response.data\n      } : pet)); // if pet id matches then update\n\n      setNewPetName('');\n      navigate(`/post/${id}`);\n    } catch (err) {\n      console.log(`Error: ${err.message}`);\n    }\n  }; // ------------------- DELETE in CRUD ------------------- //\n\n\n  const handleDelete = async id => {\n    try {\n      await api.delete(`${userID}/pets/${id}`, {\n        headers: {\n          'x-access-token': auth.accessToken\n        }\n      });\n      const petsList = pets.filter(pet => pet.id !== id); // filter out the posts with post.id not equal to the id of the post we want to delete\n\n      setPets(petsList); // setPets to the newly filtered postsList\n    } catch (err) {\n      console.log(`Error: ${err.message}`);\n    }\n\n    navigate('/');\n  }; // ------------------- Send Notification Email (not automated) ------------------- //\n\n\n  const API_URL = 'http://127.0.0.1:5000/pets/';\n\n  const sendEmail = async id => {\n    try {\n      const response = api.get(`${API_URL}reminder/${id}/send-email`);\n    } catch (err) {\n      if (err.response) {\n        // Not in the 200 response range\n        console.log(err.response.data);\n        console.log(err.response.status);\n        console.log(err.response.headers);\n      } else {\n        console.log(`Error: ${err.message}`);\n      }\n    }\n\n    navigate('/');\n  }; // ------------------- Filter Search Results on Home page ------------------- //\n\n\n  useEffect(() => {\n    const filteredResults = pets.filter(pet => pet.pet_name.toLowerCase().includes(search.toLowerCase()));\n    setSearchResults(filteredResults.reverse());\n  }, [pets, search]);\n  return /*#__PURE__*/_jsxDEV(DataContext.Provider, {\n    value: {\n      search,\n      setSearch,\n      searchResults,\n      setSearchResults,\n      handleSubmit,\n      petName,\n      setPetName,\n      petType,\n      setPetType,\n      dob,\n      setDob,\n      deworm,\n      setDeworm,\n      gender,\n      setGender,\n      ster,\n      setSter,\n      petDesc,\n      setPetDesc,\n      pets,\n      handleDelete,\n      sendEmail,\n      handleEdit,\n      newPetName,\n      setNewPetName,\n      newPetType,\n      setNewPetType,\n      newDob,\n      setNewDob,\n      newDeworm,\n      setNewDeworm,\n      newGender,\n      setNewGender,\n      newSter,\n      setNewSter,\n      newPetDesc,\n      setNewPetDesc,\n      user,\n      setUser,\n      pwd,\n      setPwd,\n      userID,\n      setUserID,\n      auth,\n      setAuth,\n      picURL,\n      setPicURL\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 9\n  }, this);\n};\n\n_s(DataProvider, \"MvLZtCCv7xiqswqoSu+Liy13JR0=\", false, function () {\n  return [useNavigate];\n});\n\n_c = DataProvider;\nexport default DataContext;\n\nvar _c;\n\n$RefreshReg$(_c, \"DataProvider\");","map":{"version":3,"sources":["/Users/tungngo/Dropbox/Personal/Learning/React/petbook/src/context/DataContext.js"],"names":["createContext","useState","useEffect","useRef","useNavigate","format","api","DataContext","DataProvider","children","pets","setPets","search","setSearch","searchResults","setSearchResults","picURL","setPicURL","navigate","user","setUser","pwd","setPwd","userID","setUserID","auth","setAuth","petName","setPetName","petType","setPetType","dob","setDob","deworm","setDeworm","Date","gender","setGender","ster","setSter","petDesc","setPetDesc","newPetName","setNewPetName","newPetType","setNewPetType","newDob","setNewDob","newDeworm","setNewDeworm","newGender","setNewGender","newSter","setNewSter","newPetDesc","setNewPetDesc","addPet","id","length","isSterilised","toLowerCase","newPet","pet_name","pet_type","pet_dob","pet_gender","last_deworm","sterilised","pet_description","user_id","response","post","headers","accessToken","console","log","data","allPets","err","message","handleSubmit","e","preventDefault","fetchPets","get","status","getPic","handleEdit","updatePet","patch","map","pet","toString","handleDelete","delete","petsList","filter","API_URL","sendEmail","filteredResults","includes","reverse"],"mappings":"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","sourcesContent":["import { createContext, useState, useEffect, useRef } from \"react\";\nimport { useNavigate } from 'react-router-dom';\nimport { format } from 'date-fns';\nimport api from '../api/posts';\n\nconst DataContext = createContext({});\n\nexport const DataProvider = ({ children }) => {\n    const [pets, setPets] = useState([]); /* default state is an array loaded from local storage or an empty array, in the event the database shoppinglist is deleted */\n    const [search, setSearch] = useState('');\n    const [searchResults, setSearchResults] = useState([]); // array of search results\n    const [picURL, setPicURL] = useState('')\n    const navigate = useNavigate();\n\n    // Inputs for Login\n    const [user, setUser] = useState('');\n    const [pwd, setPwd] = useState('');\n    const [userID, setUserID] = useState('');\n    const [auth, setAuth] = useState({})\n\n    // Inputs for Pet in POST\n    const [petName, setPetName] = useState('');\n    const [petType, setPetType] = useState('');\n    const [dob, setDob] = useState('');\n    const [deworm, setDeworm] = useState(format(new Date(), 'M-d-y'));\n    const [gender, setGender] = useState('');\n    const [ster, setSter] = useState('false');\n    const [petDesc, setPetDesc] = useState('');\n\n    // Inputs for Pet in PATCH\n    const [newPetName, setNewPetName] = useState(petName);\n    const [newPetType, setNewPetType] = useState(petType);\n    const [newDob, setNewDob] = useState(dob);\n    const [newDeworm, setNewDeworm] = useState(deworm);\n    const [newGender, setNewGender] = useState(gender);\n    const [newSter, setNewSter] = useState(ster);\n    const [newPetDesc, setNewPetDesc] = useState(petDesc);\n\n    // ------------------- CREATE in CRUD ------------------- //\n    const addPet = async (petName, petType, dob, deworm, gender, ster, petDesc, userID) => {\n        const id = pets.length ? pets[pets.length - 1].id + 1 : 1; // to reference the last post --> posts[posts.length-1]\n        const isSterilised = (ster.toLowerCase()) === 'true';\n        const newPet = {\n            id,\n            pet_name: petName,\n            pet_type: petType,\n            pet_dob: dob,\n            pet_gender: gender,\n            last_deworm: deworm,\n            sterilised: isSterilised,\n            pet_description: petDesc,\n            user_id: userID\n        };\n\n        try {\n            const response = await api.post(`${userID}/pets/register`, newPet, {\n                headers: {\n                    'x-access-token': auth.accessToken\n                }\n            })\n            console.log(response.data)\n            const allPets = [...pets, response.data]; // append new post to allPosts\n            setPets(allPets); // set Posts to allPosts\n            setPetName(''); // reset the setPostTitle and setPostBody to empty\n            setPetType('');\n            setDob('');\n            setDeworm(format(new Date(), 'M-d-y'));\n            setGender('');\n            setSter('false');\n            setPetDesc('');\n        } catch (err) {\n            console.log(`Error: ${err.message}`)\n        }\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        if (!petName) return;\n        addPet(petName, petType, dob, deworm, gender, ster, petDesc, userID) // addItem function\n        navigate('/'); // return to home page after submitting post\n    }\n\n    // ------------------- REQUEST in CRUD ------------------- //\n    useEffect(() => {\n        const fetchPets = async () => {\n            try {\n                // in axios, it automatically returns response in json format and catch the error, accesible through response.data\n                const response = await api.get(`${userID}/pets`, {\n                    headers: {\n                        'x-access-token': auth.accessToken\n                    }\n                });\n                setPets(response.data); // response.data is in json format\n            } catch (err) {\n                if (err.response) { // Not in the 200 response range\n                    console.log(err.response.data);\n                    console.log(err.response.status);\n                    console.log(err.response.headers);\n                } else { console.log(`Error: ${err.message}`) }\n            }\n        }\n\n        const getPic = async (id) => {\n            try {\n                // in axios, it automatically returns response in json format and catch the error, accesible through response.data\n                const response = await api.get(`${userID}/pets/${id}/upload`, {\n                    headers: {\n                        'x-access-token': auth.accessToken\n                    }\n                });\n                setPicURL(response); // response.data is in json format\n            } catch (err) {\n                if (err.response) { // Not in the 200 response range\n                    console.log(err.response.data);\n                    console.log(err.response.status);\n                    console.log(err.response.headers);\n                } else { console.log(`Error: ${err.message}`) }\n            }\n        }\n        fetchPets();\n        getPic();\n        \n    }, [userID, auth]) // [] to show dependency so it won't infinitely request from server\n\n    // ------------------- UPDATE in CRUD ------------------- //\n    const handleEdit = async (id) => {\n        const updatePet = {\n            id,\n            pet_type: newPetType,\n            pet_dob: newDob,\n            pet_gender: newGender,\n            last_deworm: newDeworm,\n            sterilised: (newSter.toLowerCase()) === 'true',\n            pet_description: newPetDesc,\n            pet_name: newPetName\n        };\n        try {\n            const response = await api.patch(`${userID}/pets/${id}`, updatePet, {\n                headers: {\n                    'x-access-token': auth.accessToken\n                }\n            });\n            console.log(response.data)\n            setPets(pets.map(pet => (pet.id).toString() === id ? { ...response.data } : pet)) // if pet id matches then update\n            setNewPetName('')\n            navigate(`/post/${id}`)\n        } catch (err) {\n            console.log(`Error: ${err.message}`)\n        }\n    }\n    // ------------------- DELETE in CRUD ------------------- //\n    const handleDelete = async (id) => {\n        try {\n            await api.delete(`${userID}/pets/${id}`, {\n                headers: {\n                    'x-access-token': auth.accessToken\n                }\n            });\n            const petsList = pets.filter(pet => pet.id !== id); // filter out the posts with post.id not equal to the id of the post we want to delete\n            setPets(petsList); // setPets to the newly filtered postsList\n        } catch (err) {\n            console.log(`Error: ${err.message}`)\n        }\n        navigate('/');\n    }\n    // ------------------- Send Notification Email (not automated) ------------------- //\n    const API_URL = 'http://127.0.0.1:5000/pets/';\n    const sendEmail = async (id) => {\n        try {\n            const response = api.get(`${API_URL}reminder/${id}/send-email`);\n        } catch (err) {\n            if (err.response) {\n                // Not in the 200 response range\n                console.log(err.response.data);\n                console.log(err.response.status);\n                console.log(err.response.headers);\n            } else { console.log(`Error: ${err.message}`) }\n        }\n        navigate('/');\n    }\n    // ------------------- Filter Search Results on Home page ------------------- //\n    useEffect(() => {\n        const filteredResults = pets.filter((pet) =>\n            ((pet.pet_name).toLowerCase()).includes(search.toLowerCase()));\n        setSearchResults(filteredResults.reverse());\n    }, [pets, search])\n    \n    return (\n        <DataContext.Provider value={{\n            search, setSearch,\n            searchResults, setSearchResults,\n            handleSubmit, petName, setPetName, petType, setPetType, dob, setDob, deworm, setDeworm, gender, setGender, ster, setSter, petDesc, setPetDesc,\n            pets, handleDelete, sendEmail,\n            handleEdit, newPetName, setNewPetName, newPetType, setNewPetType, newDob, setNewDob, newDeworm, setNewDeworm, newGender, setNewGender, newSter, setNewSter, newPetDesc, setNewPetDesc,\n            user, setUser, pwd, setPwd, userID, setUserID, auth, setAuth, picURL, setPicURL\n        }}>\n            {children}\n        </DataContext.Provider>\n    )\n}\n\nexport default DataContext;"]},"metadata":{},"sourceType":"module"}