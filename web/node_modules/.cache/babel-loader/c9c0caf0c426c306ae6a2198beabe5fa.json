{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tungngo/Dropbox/Personal/Learning/React/webapp/petbook/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tungngo/Dropbox/Personal/Learning/React/webapp/petbook/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/tungngo/Dropbox/Personal/Learning/React/webapp/petbook/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useRef,useState,useEffect,useContext}from'react';import DataContext from'../context/DataContext';import{useNavigate}from'react-router-dom';import axios from'../api/axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var REGISTER_URL='/register';var Register=function Register(){// const { setAuth } = useContext(AuthContext);\nvar userRef=useRef();var errRef=useRef();var _useContext=useContext(DataContext),user=_useContext.user,setUser=_useContext.setUser,email=_useContext.email,setEmail=_useContext.setEmail,pwd=_useContext.pwd,setPwd=_useContext.setPwd;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),errMsg=_useState2[0],setErrMsg=_useState2[1];var navigate=useNavigate();// const location = useLocation();\n// const from = location.state?.from.pathname || \"/\";\nuseEffect(function(){userRef.current.focus();},[]);useEffect(function(){setErrMsg('');},[user,pwd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response,_err$response,_err$response2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return axios.post(REGISTER_URL,JSON.stringify({username:user,email:email,password:pwd}),{headers:{'Content-Type':'application/json'}// withCredentials: true\n});case 4:response=_context.sent;console.log(JSON.stringify(response===null||response===void 0?void 0:response.data));navigate('/login');setUser('');setPwd('');setEmail('');_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);if(!(_context.t0===null||_context.t0===void 0?void 0:_context.t0.response)){setErrMsg('No Server Response');}else if(((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.status)===400){setErrMsg('Missing Username or Password');}else if(((_err$response2=_context.t0.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setErrMsg('Wrong Username or Password');}else{setErrMsg('Registration Failed');}errRef.current.focus();case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"p\",{ref:errRef,className:errMsg?\"errmsg\":\"offscreen\",\"aria-live\":\"assertive\",children:errMsg}),/*#__PURE__*/_jsx(\"h1\",{children:\"Sign Up\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setUser(e.target.value);},value:user,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"email\",onChange:function onChange(e){return setEmail(e.target.value);},value:email,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",onChange:function onChange(e){return setPwd(e.target.value);},value:pwd,required:true}),/*#__PURE__*/_jsx(\"button\",{children:\"Register\"})]})]});};export default Register;","map":{"version":3,"sources":["/Users/tungngo/Dropbox/Personal/Learning/React/webapp/petbook/web/src/login/Register.js"],"names":["useRef","useState","useEffect","useContext","DataContext","useNavigate","axios","REGISTER_URL","Register","userRef","errRef","user","setUser","email","setEmail","pwd","setPwd","errMsg","setErrMsg","navigate","current","focus","handleSubmit","e","preventDefault","post","JSON","stringify","username","password","headers","response","console","log","data","status","target","value"],"mappings":"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","sourcesContent":["import { useRef, useState, useEffect, useContext } from 'react';\nimport DataContext from '../context/DataContext';\nimport { useNavigate } from 'react-router-dom';\n\nimport axios from '../api/axios';\nconst REGISTER_URL = '/register';\n\nconst Register = () => {\n    // const { setAuth } = useContext(AuthContext);\n    const userRef = useRef();\n    const errRef = useRef();\n\n    const { user, setUser, email, setEmail, pwd, setPwd } = useContext(DataContext);\n    const [errMsg, setErrMsg] = useState('');\n\n    const navigate = useNavigate();\n    // const location = useLocation();\n    // const from = location.state?.from.pathname || \"/\";\n\n    useEffect(() => {\n        userRef.current.focus();\n    }, [])\n\n    useEffect(() => {\n        setErrMsg('');\n    }, [user, pwd])\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        try {\n            const response = await axios.post(REGISTER_URL,\n                JSON.stringify({ username: user, email: email, password: pwd }),\n                {\n                    headers: { 'Content-Type': 'application/json' },\n                    // withCredentials: true\n                }\n            );\n            console.log(JSON.stringify(response?.data))\n            navigate('/login');\n            setUser('');\n            setPwd('');\n            setEmail('');\n\n        } catch (err) {\n            if (!err?.response) {\n                setErrMsg('No Server Response');\n            } else if (err.response?.status === 400) {\n                setErrMsg('Missing Username or Password');\n            } else if (err.response?.status === 401) {\n                setErrMsg('Wrong Username or Password');\n            } else {\n                setErrMsg('Registration Failed');\n            }\n            errRef.current.focus();\n        }\n    }\n\n    return (\n            <section>\n                <p ref={errRef} className={errMsg ? \"errmsg\" : \"offscreen\"} aria-live=\"assertive\">{errMsg}</p>\n                <h1>Sign Up</h1>\n                <form onSubmit={handleSubmit}>\n                    <label htmlFor=\"username\">Username:</label>\n                    <input\n                        type=\"text\"\n                        id=\"username\"\n                        ref={userRef}\n                        autoComplete=\"off\"\n                        onChange={(e) => setUser(e.target.value)}\n                        value={user}\n                        required\n                    />\n\n                    <label htmlFor=\"email\">Email:</label>\n                    <input\n                        type=\"text\"\n                        id=\"email\"\n                        onChange={(e) => setEmail(e.target.value)}\n                        value={email}\n                        required\n                    />\n\n                    <label htmlFor=\"password\">Password:</label>\n                    <input\n                        type=\"password\"\n                        id=\"password\"\n                        onChange={(e) => setPwd(e.target.value)}\n                        value={pwd}\n                        required\n                    />\n                    <button>Register</button>\n                </form>\n\n            </section>\n\n    )\n}\n\nexport default Register"]},"metadata":{},"sourceType":"module"}